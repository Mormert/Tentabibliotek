<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html lang="sv">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Operativsystem för civilingenjörer: Hemtentamen 2020-08-24</title>
<STYLE TYPE="text/css">
     P.breakhere {page-break-before: always}
</STYLE>
</head>

<body bgcolor="#ffffff" text="#000000" link="#0000cc" vlink="#551a8b" alink="#ff0000">


<h1><a href="../../index.html">Operativsystem för civilingenjörer</a>: Hemtentamen 2020-08-24</h1>

Det här är hemtentan som går måndag 24 augusti 2020 i kursen
DT513G Operativsystem för civilingenjörer
vid Örebro universitet, provkod A001.
Ansvarig lärare är
<a href="http://www.aass.oru.se/~tpy/">Thomas Padron-McCarthy</a>
(<a href="mailto:thomas.padron-mccarthy@oru.se?subject=Operativsystem-hemtenta 2020-08-24">thomas.padron-mccarthy@oru.se</a>),
telefon <b>070-73 47 013</b>.

<p>

Tid: 08:15 - 13:15




<h2>Instruktioner</h2>

<ol>

<li>
Den här hemtentan ersätter den planerade salstentan, och är endast för de studenter som anmält sig till den tentan.

<li>
Uppgifterna ska lösas enskilt, dvs inga grupper av två eller flera studenter.

<li>
<b>Du får använda dator, böcker och vilka andra hjälpmedel som helst,</b>
men du får inte samarbeta eller fråga någon (utom mig).
Exempelvis är det tillåtet att söka och läsa på webbplatser som Stack Overflow, men inte att ställa egna frågor.
Du kan alltså provköra kommandon och program, om du vill.

<li>
<b>Diskutera inte uppgifterna eller dela med dig av svar förrän tidigast dagen efter tentan.</b>

<li>
Lös de angivna uppgifterna och samla svaren på lämpligt sätt,
till exempel i en PDF.
Skicka sen in lösningarna till mig i
<a href="http://lms.oru.se/">Blackboard</a>.
Välj <b>Kursmaterial</b> i menyn till vänster på kursens Blackboard-sida,
gå in i mappen <b>Hemtentamen</b>,
och välj den rätta tentan.
Där kan man sedan välja att skicka in sin lösning.
Då blir bedömningen anonym.
Glöm inte att klicka på knappen <b>Skicka</b> längst ner till höger.

<li>
Om det skulle bli problem med Blackboard,
kan man i nödfall skicka in svaren
antingen som ett kursmeddelande i Blackboard
eller via vanlig e-post
(<a href="mailto:thomas.padron-mccarthy@oru.se?subject=Databasteknik-hemtenta 2020-06-03">thomas.padron-mccarthy@oru.se</a>),
senast vid tentatidens slut.
Då blir bedömningen inte anonym.

<li>
I Blackboard ser du att du skickat in din lösning.
Om du i stället skickade in med e-post,
och inte senast en timme efter tentatidens slut fått
ett svar från mig med en bekräftelse
på att du skickat in svaren,
bör du kontakta mig, enklast genom att ringa eller SMS:a mig
(ifall det är e-posten som inte fungerar).
Tänk på att en del mailtjänster
(särskilt Microsoft-tjänster som Hotmail.com, Outlook.com och Live.com)
ibland kastar bort brev med bilagor, utan att meddela det.

<li>
Skriv gärna svaren i ett ordbehandlingsprogram.
Rita gärna eventuella diagram i ett ritprogram.
Det är inte förbjudet att skriva och rita för hand,
men då måste text och bilder scannas in eller fotograferas.
Det finnas scanner-appar till Android och iPhone,
till exempel Adobe Scan,
som ger bättre resultat än att bara ta vanliga kort med kameran.

<li>
Tentatiden är utökad med en extra timme
för att täcka in problem med e-post, inscanning eller fotografering av diagram, och liknande.

<li>
Om du behöver fråga något, så kontakta gärna mig.
Ring eller skicka SMS,
för jag kanske inte kommer att sitta vid datorn hela tiden.

<li>
Oklara och tvetydiga formuleringar kommer att misstolkas.
Lösningar som inte går att läsa eller förstå kan naturligtvis inte ge några poäng. 

<li>
Antaganden utöver de som står i uppgifterna måste anges. Gjorda antaganden får inte förändra den givna uppgiften.

<li>
Skriv gärna förklaringar om hur du tänkt. Även ett svar som är fel kan ge poäng, om det finns med en förklaring som visar att huvudtankarna var rätt. 

<li>
Maximal poäng är 26.
För godkänt betyg krävs minst 13 poäng.

<li>
Resultat meddelas senast 15 arbetsdagar efter tentamensdatum.
Eftersom svaren skickas in elektroniskt scannas tentorna inte för retur.

</ol>



<P CLASS="breakhere">



<a name="uppgift-1"></a>
<h2>Uppgift 1 (5 p)</h2>

Behöver alla datorerer ha operativsystem? Diskutera!



<a name="uppgift-2"></a>
<h2>Uppgift 2 (5 p)</h2>

Operativsystemkärnan kan ha olika arkitekturer.
Även om man numera oftast kombinerar dem,
är extremerna en mikrokärna ("microkernel" på engelska)
och en monolitisk kärna ("monolithic kernel").

<p>

a) Vad innebär en monolitisk kärna?

<p>

b) Vad innebär en mikrokärna?
  
<p>

c) Vilka fördelar och nackdelar har de två?

<p>

d) Jag skrev ovan att man numera oftast kombinerar dem.
Hur går det till?
Vilka fördelar ger det?



<a name="uppgift-3"></a>
<h2>Uppgift 3 (6 p)</h2>

Vi konstruerar en processor där fysiska adresser är 20 bitar,
medan virtuella adresser är 36 bitar,
varav 23 bitar är sidnummer ("page number" på engelska) och 13 bitar är offset.

<p>

a) Hur mycket fysiskt minne kan man adressera? Visa också hur du räknat.

<p>

b) Hur mycket virtuellt minne kan man adressera? Visa också hur du räknat.

<p>

c) Hur stora är minnessidorna? Visa också hur du räknat.

<p>

d) Hade det varit rimligt att ha en offsetdel som var 12 bitar i stället för 13?
Motivera svaret.

<p>

e) Hade det varit rimligt att ha en offset som var 3 bitar? Motivera svaret.

<p>

f) Hade det varit rimligt att ha en offset som var 34 bitar? Motivera svaret.



<a name="uppgift-4"></a>
<h2>Uppgift 4 (10 p)</h2>

Här nedan finns ett program,
<a href="threads.c">threads.c</a>,
som startar 100 trådar,
och var och en av trådarna ökar variabeln <b>the_big_number</b> en miljard gånger.
Slutresultatet borde förstås bli att variabeln innehåller värdet 100 miljarder.

<p>

<table border="1" cellspacing="0" cellpadding="3" width="90%"><tr><td bgcolor="yellow">
Vi antar att alla provkörningar i den här uppgiften görs på en normal, modern
dator. Det kan vara en stationär dator eller en bärbar dator.
Det är tillåtet att provköra på riktigt när man löser uppgiften,
men det går att besvara alla frågorna även utan att provköra.
Man måste i vilket fall som helst förklara sina svar.
Det är förklaringarna som är det viktiga.
</td></tr></table>

<p>

<table border="1" cellspacing="0" cellpadding="3" width="90%"><tr><td bgcolor="#ccffcc">
<pre>
// Many threads, each incrementing the same variable many times
// Note 1: Normal "int" is too small for some of the values,
// so we use "long long int".
// Note 2: An optimizing compiler might remove the actual calculations,
// so don't compile with -O2 or similar.
// Thomas Padron-McCarthy (thomas.padron-mccarthy@oru.se)
// Fri Aug 21 10:22:16 CEST 2020

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;limits.h&gt;
#include &lt;pthread.h&gt;

#define TOTAL_NR_INCREMENTS (1LL*1000*1000*1000)
#define NR_THREADS 100
#define NR_INCREMENTS_PER_THREAD (TOTAL_NR_INCREMENTS / NR_THREADS)

pthread_t threads[NR_THREADS];

long long int the_big_number = 0;

void *thread_body(void *arg) {
    int thread_number = (int)arg;
    for (long long int i = 0; i &lt; NR_INCREMENTS_PER_THREAD; ++i) {
        the_big_number ++;
    }
    return NULL;
} // thread_body

int main(void) {
    printf("This program increments the same variable %lld times,\n",
           TOTAL_NR_INCREMENTS);
    printf("using %d thread(s), each incrementing the variable %lld times.\n",
           NR_THREADS, NR_INCREMENTS_PER_THREAD);

    printf("Starting the %d threads...\n", NR_THREADS);

    for (int i = 0; i &lt; NR_THREADS; ++i) {
        if (pthread_create(&amp;threads[i], NULL, thread_body, (void*)i) != 0) {
	    printf("Couldn't create thread %d.\n", i);
	    exit(EXIT_FAILURE);
	}
    }

    printf("%d threads started. Waiting for them to finish...\n", NR_THREADS);

    for (int i = 0; i &lt; NR_THREADS; ++i) {
	if (pthread_join(threads[i], NULL) != 0) {
	    printf("Couldn't join thread for thread %d.\n", i);
	    exit(EXIT_FAILURE);
	}
    }
    
    printf("All threads finished!\n");
    printf("The variable now has the value = %lld.\n", the_big_number);
    printf("It should be %lld.\n", TOTAL_NR_INCREMENTS);
    if (the_big_number == TOTAL_NR_INCREMENTS)
        printf("Ok! As expected!\n");
    else
        printf("Error! Wrong result!\n");

    return EXIT_SUCCESS;
} // main
</pre>
</td></tr></table>

<p>

a) Vi kör programmet.
Det tar 2,3 sekunder,
men variabelns värde blir inte alls 100 miljarder, utan 37226719.
Vad beror det på att det blir fel värde?

<p>

b) Vi kör programmet en gång till. Det tar 2,3 sekunder den här gången också,
men nu blir variabelns värde 39579883, alltså ett annat värde än förra gången.
Vad beror det på att det blir ett annat värde?

<p>

c) Vi ändrar konstanten <b>NR_THREADS</b> till <b>1</b>,
så det bara körs en enda tråd, och kör programmet ännu en gång.
Vad får variabeln för värde nu? Varför?

<p>

d) Vi ändrar tillbaka konstanten <b>NR_THREADS</b> till <b>100</b>.
Ändra programmet så det ger rätt resultat,
även med 100 parallella trådar!
(Det är som sagt tillåtet att provköra,
men det räcker med att visa vilka rader som
behöver läggas till i programmet.)

<p>

e) Vi kör programmet från deluppgift <b>d</b> ovan.
Om du gjort rätt får variabeln det förväntade värdet.
Men ungefär hur lång tid kan man räkna med att det tar att köra programmet? Varför?

<p>

f) Jag vill att programmet ska gå fortare att köra,
så jag ändrar konstanten <b>NR_THREADS</b> till <b>1000</b>.
Vad händer med körtiden jämfört med när det var 100 trådar? Varför?

<p>

<hr>

<font size=-1>
<a href="http://www.aass.oru.se/~tpy/">Thomas Padron-McCarthy</a>
(<a href="mailto:thomas.padron-mccarthy@oru.se?subject=Operativsystem-hemtenta 2020-08-24">thomas.padron-mccarthy@oru.se</a>),
21 augusti 2020
</font>

</body>
</html>
